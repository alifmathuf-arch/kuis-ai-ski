<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kuis AI SKI Kelas XII</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.2.0"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg,#e3f2fd,#fff);
  margin: 0;
  display: flex;
  justify-content: center;
}

.container {
  width: 100%;
  max-width: 430px;
  background: #fff;
  margin: 20px;
  padding: 20px;
  border-radius: 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,.12);
  text-align: center;
}

h2 { color:#0d47a1; margin-bottom:4px; }
.subtitle { font-size:14px; color:#555; }

input {
  width: 100%;
  padding: 12px;
  margin: 12px 0;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 16px;
}

button {
  width: 100%;
  padding: 14px;
  margin-top: 10px;
  border: none;
  border-radius: 12px;
  background: #1565c0;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}
button:hover { background:#0d47a1; }

video {
  width:100%;
  border-radius:14px;
  margin-top:10px;
}

.info {
  margin-top:12px;
  font-size:15px;
}

#hasil {
  margin-top: 10px;
  font-size: 18px;
  font-weight: bold;
  color: #2e7d32;
}

footer {
  margin-top: 18px;
  font-size: 12px;
  color: #777;
}
</style>
</head>

<body>
<div class="container">

<h2>Kuis AI SKI XII</h2>
<div class="subtitle">Arahkan kamera ke kartu jawaban</div>

<div id="login">
  <input id="nama" placeholder="Nama Siswa">
  <button onclick="mulai()">‚ñ∂ Mulai Kuis</button>
</div>

<div id="quiz" style="display:none">
  <div class="info">
    üë§ <span id="namaSiswa"></span><br>
    üìò Soal <span id="nomor">1</span> / 10<br>
    ‚≠ê Skor: <span id="skor">0</span>
  </div>

  <div id="kamera"></div>
  <div id="hasil">Menunggu jawaban...</div>
</div>

<div id="rekap" style="display:none">
  <h3>üìä Rekap Hasil</h3>
  <p>Nama: <b id="rekapNama"></b></p>
  <p>Skor Akhir: <b id="rekapSkor"></b> / 10</p>
</div>

<footer>
  Informatika ‚Ä¢ AI Edukasi ‚Ä¢ Aman
</footer>

</div>

<script>
const URL = "https://teachablemachine.withgoogle.com/models/oG8yzZaWr/";

let model, video;
let soal = 1;
let skor = 0;
let namaSiswa = "";

// ‚ö†Ô∏è SESUAIKAN NAMA CLASS MODEL
const kunciJawaban = {
  1: "A",
  2: "B",
  3: "C",
  4: "D",
  5: "A",
  6: "B",
  7: "C",
  8: "D",
  9: "A",
  10:"B"
};

async function mulai(){
  namaSiswa = document.getElementById("nama").value.trim();
  if(!namaSiswa){
    alert("Nama wajib diisi");
    return;
  }

  document.getElementById("login").style.display="none";
  document.getElementById("quiz").style.display="block";
  document.getElementById("namaSiswa").innerText = namaSiswa;

  model = await tmImage.load(URL+"model.json", URL+"metadata.json");
  await setupCamera();
  loop();
}

async function setupCamera(){
  video = document.createElement("video");
  video.setAttribute("playsinline","");
  video.autoplay = true;

  const stream = await navigator.mediaDevices.getUserMedia({
    video:{ facingMode:{ exact:"environment" } }
  });

  video.srcObject = stream;
  await video.play();

  document.getElementById("kamera").appendChild(video);
}

async function loop(){
  const pred = await model.predict(video);
  const terbaik = pred.reduce((a,b)=>a.probability>b.probability?a:b);

  if(terbaik.probability > 0.90){
    cekJawaban(terbaik.className);
  }

  requestAnimationFrame(loop);
}

function cekJawaban(jawaban){
  if(jawaban === kunciJawaban[soal]){
    skor++;
    document.getElementById("hasil").innerText="‚úÖ BENAR";
  } else {
    document.getElementById("hasil").innerText="‚ùå SALAH";
  }

  document.getElementById("skor").innerText = skor;

  soal++;
  if(soal > 10){
    selesai();
  } else {
    document.getElementById("nomor").innerText = soal;
    setTimeout(()=>{ document.getElementById("hasil").innerText="Menunggu jawaban..."; },1000);
  }
}

function selesai(){
  document.getElementById("quiz").style.display="none";
  document.getElementById("rekap").style.display="block";
  document.getElementById("rekapNama").innerText = namaSiswa;
  document.getElementById("rekapSkor").innerText = skor;
}
</script>
</body>
</html>
